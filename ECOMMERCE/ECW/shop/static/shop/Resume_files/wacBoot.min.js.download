var wacBoot=function(e){function t(t){for(var n,o,a=t[0],s=t[1],r=0,d=[];r<a.length;r++)o=a[r],i[o]&&d.push(i[o][0]),i[o]=0;for(n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n]);for(l&&l(t);d.length;)d.shift()()}var n={},i={1:0};function o(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,o),i.l=!0,i.exports}o.e=function(e){var t=[],n=i[e];if(0!==n)if(n)t.push(n[2]);else{var a=new Promise((function(t,o){n=i[e]=[t,o]}));t.push(n[2]=a);var s,r=document.createElement("script");r.charset="utf-8",r.timeout=120,o.nc&&r.setAttribute("nonce",o.nc),r.src=function(e){return o.p+""+({0:"headerBoot"}[e]||e)+".min.js"}(e),0!==r.src.indexOf(window.location.origin+"/")&&(r.crossOrigin="anonymous"),s=function(t){r.onerror=r.onload=null,clearTimeout(l);var n=i[e];if(0!==n){if(n){var o=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src,s=new Error("Loading chunk "+e+" failed.\n("+o+": "+a+")");s.type=o,s.request=a,n[1](s)}i[e]=void 0}};var l=setTimeout((function(){s({type:"timeout",target:r})}),12e4);r.onerror=r.onload=s,document.head.appendChild(r)}return Promise.all(t)},o.m=e,o.c=n,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="",o.oe=function(e){throw console.error(e),e};var a=window.webpackJsonp_name_=window.webpackJsonp_name_||[],s=a.push.bind(a);a.push=t,a=a.slice();for(var r=0;r<a.length;r++)t(a[r]);var l=s;return o(o.s=3)}([function(e,t,n){"use strict";n.r(t);var i=window.__foldables_env_vars__,o=function(e,t,n,i,o){void 0===o&&(o=!1),this.left=e,this.right=e+n,this.top=t,this.bottom=t+i,this.x=e,this.y=t,this.width=n,this.height=i,this.pixelDepth=0,this.devicePixelRatio=0,this.isOccluded=o};function a(){!function(){if("function"==typeof window.CustomEvent)return;window.CustomEvent=function(e,t){var n=t||{bubbles:!1,cancelable:!1,detail:null},i=document.createEvent("CustomEvent");return i.initCustomEvent(e,n.bubbles,n.cancelable,n.detail),i}}(),function(){if("function"==typeof window.DOMRect)return;window.DOMRect=function(e){return{x:0,y:0,width:window.innerWidth,height:window.innerHeight}}}(),function(){if("object"==typeof window.onBoundingWindowRectsChange)return;window.onBoundingWindowRectsChange=new CustomEvent("onBoundingWindowRectsChange",{bubbles:!1,cancelable:!1}),window.addEventListener("resize",s)}(),function(){if("function"==typeof window.getWindowSegments)return;window.getWindowSegments=function(){var e=window.innerWidth,t=window.innerHeight;try{if(window.external&&window.external.getHostEnvironmentValue&&'{"os-sku":"189"}'===window.external.getHostEnvironmentValue("os-sku")){if(window.matchMedia&&window.matchMedia("(orientation: portrait)").matches&&t>=1300&&964===e)return i&&i.update({spanning:"single-fold-horizontal"}),[new o(0,0,e,t/2),new o(0,t/2,e,t/2)];if(window.matchMedia&&window.matchMedia("(orientation: landscape)").matches&&t>=820&&1440===e)return i&&i.update({spanning:"single-fold-vertical"}),[new o(0,0,e/2,t),new o(e/2,0,e/2,t)];i&&i.update({spanning:"none"})}}catch(e){}return[new o(0,0,e,t)]}}()}function s(){window.dispatchEvent(window.onBoundingWindowRectsChange)}function r(){Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw TypeError('"this" is null or not defined');var t=Object(this),n=t.length>>>0;if("function"!=typeof e)throw TypeError("predicate must be a function");for(var i=arguments[1],o=0;o<n;){var a=t[o];if(e.call(i,a,o,t))return a;o+=1}},configurable:!0,writable:!0})}function l(){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var n=Object(e),i=1;i<arguments.length;i+=1){var o=arguments[i];if(null!=o)for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(n[a]=o[a])}return n},writable:!0,configurable:!0})}var d={},c={},u={},p={Small:{Portrait:720,Landscape:960,DP:1440,DL:1920},Large:{Portrait:721,Landscape:961,DP:1441,DL:1921}},h=[],m=void 0,b=-1,f="Undefined",g="Default",w=!1;function v(){var e,t,n;return null===(n=null===(e=window)||void 0===e?void 0:(t=e).matchMedia)||void 0===n?void 0:n.call(t,"(prefers-reduced-motion: reduce)").matches}function S(){return"DP"===L()}function y(){return"DL"===L()}function C(e){return R(e,0)}function R(e,t){if(e&&h&&!(h.length<=0)){if(1===h.length)return k(h[0],t);var n;if("string"==typeof e){var i=document.querySelector(e);if(!i)return;n=i.getBoundingClientRect()}else if(void 0!==e.preventDefault){var a=e;n=new o(a.clientX,a.clientY,1,1)}else if(e.getBoundingClientRect)n=e.getBoundingClientRect();else if(e){var s=e;n=new o(s.x,s.y,1,1)}else{if(!e.current)return;n=e.current.getBoundingClientRect()}var r=P(n);return r&&k(r,t)}}function E(e,t){return R(e,8)}function k(e,t){return l(),e&&Object.assign({},e,{top:e.top+t,left:e.left+t,right:e.right-t,bottom:e.bottom-t,width:e.width-2*t,height:e.height-2*t})}function P(e){return A(e)?h[0]:(r(),h.find((function(t){return O(e,t)})))}function O(e,t){return e.left>=t.left&&e.top>=t.top&&e.right<=t.left+t.width&&e.bottom<=t.top+t.height}function I(e){return void 0!==e&&("DL"===L()||"DP"===L())&&A(e.getBoundingClientRect())}function A(e){return!(h.length<=1)&&(e.right>h[0].left+h[0].width?e.left<h[1].left:e.bottom>h[0].top+h[0].height&&e.top<h[1].top)}function x(e,t){if(h.length<=1)return-1;if(t){if(e.left<h[1].left)return e.right-h[0].right;if(e.top<h[1].top)return e.bottom-h[0].bottom}else{if(e.right>h[0].left+h[0].width)return h[1].left-e.left;if(e.bottom>h[0].top+h[0].height)return h[1].top-e.top}return-1}function B(e,t){d[e]=t}function N(e){void 0!==d[e]&&delete d[e]}function T(e,t){c[e]=t}function W(e){void 0!==c[e]&&delete c[e]}function M(e,t){u[e]=t}function F(e){void 0!==u[e]&&delete u[e]}function D(){window.getWindowSegments||a();var e=window.getWindowSegments(),t=!1;if(e.length!==h.length&&(t=!0),1===(h=e).length){var n=h[0];f=n.width>n.height?"Landscape":"Portrait"}else h.length<=1||h[0].top!==h[1].top?h.length<=1||h[0].left!==h[1].left||(t=t||"DP"===f,f="DL"):(t=t||"DL"===f,f="DP");var i=g;"Landscape"===f||"DL"===f?g=h[0].width<=960?"Small":"Large":"Portrait"!==f&&"DP"!==f||(g=h[0].width<=720?"Small":"Large"),function(){var e=h;for(var t in m&&e.push(m),c)c[t](e,f)}(),t&&function(e){for(var t in d)d[t](e,f)}("DL"===f||"DP"===f),i!==g&&function(){for(var e in u)u[e](g)}()}function L(){if("Undefined"===f){var e=window.getWindowSegments?window.getWindowSegments():void 0;return!e||e.length<=1?window.innerWidth>window.innerHeight?"Landscape":"Portrait":window.innerWidth>window.innerHeight?"DP":"DL"}return f}function _(){return g}function V(){return m}function H(){return h}function q(){w||("undefined"!=typeof navigator&&navigator.virtualKeyboard&&void 0!==navigator.virtualKeyboard.overlaysContent&&(window===top&&(navigator.virtualKeyboard.overlaysContent=!0),navigator.virtualKeyboard.addEventListener("overlaygeometrychange",U)),a(),window.addEventListener("onBoundingWindowRectsChange",D),h&&0!==h.length||D(),w=!0)}function U(e){var t=e.boundingRect,n=t.width,i=t.height,o=t.left;0===n||0===i?(m=void 0,b=-1):((m=e.boundingRect).isOccluded=!0,b=o>0||"DL"===L()?1:0),D()}function z(){if(m)return h[b]}q(),n.d(t,"WindowSegment",(function(){return o})),n.d(t,"ensureWindowsAPIs",(function(){return a})),n.d(t,"arrayFindPolyfill",(function(){return r})),n.d(t,"objectAssignPolyfill",(function(){return l})),n.d(t,"LayoutBreakpointSizes",(function(){return p})),n.d(t,"isReducedAnimations",(function(){return v})),n.d(t,"isDPMode",(function(){return S})),n.d(t,"isDLMode",(function(){return y})),n.d(t,"getBoundingWindow",(function(){return C})),n.d(t,"getBoundingWindowWithPadding",(function(){return R})),n.d(t,"getBoundingWindowWithPaddingFabric",(function(){return E})),n.d(t,"getBoundingRect",(function(){return P})),n.d(t,"isRectWithin",(function(){return O})),n.d(t,"isElementSpanning",(function(){return I})),n.d(t,"isRectSpanning",(function(){return A})),n.d(t,"getRectSpanningOffset",(function(){return x})),n.d(t,"registerSpanningChanged",(function(){return B})),n.d(t,"unregisterSpanningChanged",(function(){return N})),n.d(t,"registerBoundingWindowRectsChanged",(function(){return T})),n.d(t,"unregisterBoundingWindowRectsChanged",(function(){return W})),n.d(t,"registerLayoutBreakpointChanged",(function(){return M})),n.d(t,"unregisterLayoutBreakpointChanged",(function(){return F})),n.d(t,"onWindowRectsChange",(function(){return D})),n.d(t,"getWindowMode",(function(){return L})),n.d(t,"getLayoutBreakpoint",(function(){return _})),n.d(t,"getKeyboardSegment",(function(){return V})),n.d(t,"getWindowRectsWithoutKeyboard",(function(){return H})),n.d(t,"initializeBaseWindowUtil",(function(){return q})),n.d(t,"getWindowRectForKeyboardSegment",(function(){return z}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"d",(function(){return o})),n.d(t,"b",(function(){return a})),n.d(t,"c",(function(){return s}));var i=function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function o(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n}function a(e,t,n,i){return new(n||(n=Promise))((function(o,a){function s(e){try{l(i.next(e))}catch(e){a(e)}}function r(e){try{l(i.throw(e))}catch(e){a(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,r)}l((i=i.apply(e,t||[])).next())}))}function s(e,t){var n,i,o,a,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function r(a){return function(r){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,i&&(o=2&a[0]?i.return:a[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,a[1])).done)return o;switch(i=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return s.label++,{value:a[1],done:!1};case 5:s.label++,i=a[1],a=[0];continue;case 7:a=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){s=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){s.label=a[1];break}if(6===a[0]&&s.label<o[1]){s.label=o[1],o=a;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(a);break}o[2]&&s.ops.pop(),s.trys.pop();continue}a=t.call(e,s)}catch(e){a=[6,e],i=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,r])}}}},,function(e,t,n){"use strict";n.r(t);var i,o=n(1),a=function(e){i=e},s=function(){return i},r=n(0),l=function(){function e(){}return e.initialize=function(){e.ctrlWheelOccurred=!1,document.addEventListener("wheel",e.handleWheel)},e.stop=function(){document.removeEventListener("wheel",e.handleWheel)},e.handleWheel=function(t){t.ctrlKey&&(e.ctrlWheelOccurred=!0)},e}();window.g_initializeCtrWheelMetrics&&l.initialize();var d,c={g_initialRequestMade:!1,g_initialRequestCompleted:!1,g_getCellsFromFrameRequest:void 0,g_initialRequestResponseObject:void 0,g_acquireLockStartTime:void 0,g_acquireLockEndTime:void 0,g_acquireLockRequestStatus:void 0,g_getDocumentStartTime:void 0,g_getDocumentEndTime:void 0,g_getDocumentRequestStatus:void 0,g_getCellsStartTime:void 0,g_getCellsEndTime:void 0,g_getInitializeLocalCobaltStartTime:void 0,g_getInitializeLocalCobaltEndTime:void 0,g_initialResponseTime:void 0,g_initialResponseReadyTime:void 0,g_fastViewOpenTime:void 0,g_initialRequestInvokedTime:void 0,g_onInitialResponseReady:void 0,g_isUserCreatingPersonalNotebookFirstTime:!1,g_networkType:void 0,g_bootSSRData:void 0,g_bootSSRHtmlStringLength:void 0},u={fastView:void 0,initialParaId:0,fastBootError:void 0},p=function(){function e(){}return e.ensureCookieCompliance=function(e,t){if(e){var n=[];t&&(n=JSON.parse(t)),WacCookieCompliance.requestConsentWithSettings(new CookieComplianceSettings(n))}},e.getCookie=function(e){if(!e)return"";if(e.indexOf("=")>=0)throw new RangeError(" = is not found in the cookie");var t=""+document.cookie,n=new RegExp("(?:^|; )"+e+"=([^;]*)"),i=t.match(n);return!i||i.length<2?"":i[1]},e.isDocumentEmpty=function(e){function t(e,t){return-1===(" "+e.className+" ").indexOf(" "+t+" ")}var n=e.querySelectorAll(".Paragraph");return!(!n||1!==n.length)&&(2===n[0].childElementCount&&!t(n[0].children[0],"TextRun")&&!t(n[0].children[1],"EOP")&&""===n[0].children[0].innerText)},e}(),h=function(){function e(){}return e.getElement=function(e){if(this.DOMElements.hasOwnProperty(e))return this.DOMElements[e];var t=document.getElementById(e);return t?this.DOMElements[e]=t:null},e.removeElement=function(e){e&&this.DOMElements.hasOwnProperty(e.id)&&delete this.DOMElements[e.id],e&&e.parentNode&&e.parentNode.removeChild(e)},e.removeElementById=function(e){this.removeElement(this.getElement(e))},e.DOMElements={},e}(),m=function(){function e(){}return e.initialize=function(e,t,n,i,o,a,s,r,l,d,c,u,h){this.isViewMode=e,this.isEmbedMode=t,this.isTeamsSession=n,this.isInTouchMode="ontouchstart"in window,this.isSimplifiedReactRibbonInTreatment=i,this.isOldRibbonCollapsedCookieOn="false"!==p.getCookie(o).toLowerCase(),this.isSimplifiedRibbonCookieOn="false"!==p.getCookie(a).toLowerCase(),this.isNewHeaderShown=!this.isViewMode,this.isSimplifiedReactRibbonShown=this.isSimplifiedReactRibbonInTreatment&&this.isSimplifiedRibbonCookieOn&&!this.isViewMode,this.isOldRibbonExpandedAndShown=!this.isSimplifiedReactRibbonShown&&!this.isOldRibbonCollapsedCookieOn&&!this.isViewMode,this.isOldRibbonCollapsedAndShown=!this.isSimplifiedReactRibbonShown&&this.isOldRibbonCollapsedCookieOn&&!this.isViewMode,this.isViewModeAndRibbonPanelSmall=this.isViewMode&&this.isOldRibbonCollapsedCookieOn&&!this.isSimplifiedReactRibbonInTreatment,this.isViewModeAndRibbonPanelLarge=this.isViewMode&&(!this.isOldRibbonCollapsedCookieOn||this.isSimplifiedReactRibbonInTreatment),this.isSnackbarNavPaneEnabled=s,this.isTwoPaneNavEnabled=r,this.isCssPositionRewriteEnabled=l,this.hideSkeletalHeader=d,this.hideSkeletalRibbon=c,this.hideSkeletalNavPane=u,this.embedViewer=h},e}();!function(e){e[e.HideAnimationTime=256]="HideAnimationTime",e[e.MinWidthToShowPageColumnPane=900]="MinWidthToShowPageColumnPane",e[e.MinWidthToShowNavpane=499]="MinWidthToShowNavpane",e[e.MinWidthToResizeTwoPaneNav=425]="MinWidthToResizeTwoPaneNav",e[e.MinWidthForTwoPaneNav=300]="MinWidthForTwoPaneNav"}(d||(d={}));var b=function(){function e(){}return e.clearAriaLoadingAttributes=function(){var e=document.getElementById("applicationOuterContainer");e&&(e.removeAttribute("aria-busy"),e.removeAttribute("aria-hidden"))},e.getFastViewSkeletalClass=function(){return m.isCssPositionRewriteEnabled?this.getPositionRewriteFastViewSkeletalClass():this.getAbsoluteFastViewSkeletalClass()},e.getPositionRewriteFastViewSkeletalClass=function(){return this.getAbsoluteFastViewSkeletalClass()},e.getAbsoluteFastViewSkeletalClass=function(){var e="";return this.isRtlMode()?e="SkeletalFastViewRtl":(e="SkeletalFastView",m.isTwoPaneNavEnabled&&!m.isEmbedMode?e="SkeletalFastView":m.isEmbedMode||this._clientWidth<=d.MinWidthToShowNavpane?e="SkeletalFastViewNoNavpane":this._clientWidth<=d.MinWidthToShowPageColumnPane&&(e="SkeletalFastViewPageColumnNavpane")),m.isViewModeAndRibbonPanelLarge&&(e+=" SkeletalFastViewViewMode"),m.isEmbedMode&&(e+=" SkeletalFastViewEmbedMode"),e},e.collapseSkeletalRibbon=function(){m.isCssPositionRewriteEnabled?this.collapsePositionRewriteSkeletalRibbon():this.collapseAbsoluteSkeletalRibbon()},e.collapsePositionRewriteSkeletalRibbon=function(){this.collapseAbsoluteSkeletalRibbon()},e.collapseAbsoluteSkeletalRibbon=function(){var e=h.getElement("SkeletalMainContent");e&&!m.isCssPositionRewriteEnabled&&(e.className+=m.isEmbedMode?" collapsedRibbonEmbedMode":" collapsedRibbon"),h.removeElementById("SkeletalRibbonExtension")},e.updateRibbonPanel=function(){m.isCssPositionRewriteEnabled&&m.isSimplifiedRibbonCookieOn?this.updatePositionRewriteRibbonPanel():this.updateAbsoluteRibbonPanel()},e.updatePositionRewriteRibbonPanel=function(){if(!this._ribbonPanelUpdated)if(m.isViewMode)this._ribbonPanelUpdated=!0;else{document.getElementById("WACRibbonPanel")&&(this._ribbonPanelUpdated=!0);var e=document.getElementsByClassName("WACReadingBarPanel").item(0);e&&(e.style.display="none")}},e.updateAbsoluteRibbonPanel=function(){if(!this._ribbonPanelUpdated){var e=document.getElementsByClassName("WACReadingBarPanel").item(0);if(m.isViewMode&&e)this._ribbonPanelUpdated=!0,m.isViewModeAndRibbonPanelLarge?e.className+=" RibbonPanelMaximizedViewMode":m.isViewModeAndRibbonPanelSmall&&(e.className+=" RibbonPanelMinimized");else{var t=document.getElementById("WACRibbonPanel");null!=t&&(this._ribbonPanelUpdated=!0,m.isSimplifiedReactRibbonShown?(t.className+=" RibbonPanelSLRMode",t.className+=" RibbonPanelNewSLRMode"):m.isOldRibbonExpandedAndShown&&!m.isInTouchMode?t.className+=" RibbonPanelMaximized":m.isOldRibbonExpandedAndShown&&m.isInTouchMode?t.className+=" RibbonPanelMaximizedTouchMode":m.isOldRibbonCollapsedAndShown&&(t.className+=" RibbonPanelMinimized")),e&&(e.style.display="none")}}},e.updateWacDocumentPanel=function(){m.isCssPositionRewriteEnabled&&m.isSimplifiedRibbonCookieOn?this.updatePositionRewriteWacDocumentPanel():this.updateAbsoluteWacDocumentPanel()},e.updatePositionRewriteWacDocumentPanel=function(){var e=document.getElementById("WACDocumentPanelContent");null!=e&&(e.style.border="unset")},e.updateAbsoluteWacDocumentPanel=function(){var e=document.getElementById("WACDocumentPanel"),t=document.getElementById("WACDocumentPanelContent");null!=e&&(e.className+=" skeletalEnabled",m.isViewModeAndRibbonPanelLarge?e.style.top="40px":m.isViewModeAndRibbonPanelSmall?e.style.top="30px":m.isSimplifiedReactRibbonShown?e.style.top="77px":m.isOldRibbonCollapsedCookieOn||m.isInTouchMode||(e.style.top="124px"),this.isRtlMode()?e.style.right="0px":m.isTwoPaneNavEnabled&&!m.isEmbedMode?this._clientWidth<d.MinWidthForTwoPaneNav?e.style.left=d.MinWidthToShowNavpane.toFixed()+"px":this._clientWidth<d.MinWidthToResizeTwoPaneNav?e.style.left=this._clientWidth.toFixed()+"px":e.style.left="426px":m.isEmbedMode||this._clientWidth<=d.MinWidthToShowNavpane?e.style.left="0px":this._clientWidth<=d.MinWidthToShowPageColumnPane?e.style.left="198px":m.isSnackbarNavPaneEnabled?e.style.left="426px":e.style.left="393px"),null!=t&&(t.style.border="unset")},e.customizeSkeletalExperience=function(){this._clientWidth=document.body.clientWidth,m.isSimplifiedReactRibbonShown?h.removeElementById("SkeletalAdditionOldRibbon"):h.removeElementById("SkeletalNewRibbon"),m.isEmbedMode&&!m.isTeamsSession||m.embedViewer?(h.removeElementById("SkeletalHeader"),h.removeElementById("SkeletalNewHeader")):m.isNewHeaderShown?h.removeElementById("SkeletalHeader"):h.removeElementById("SkeletalNewHeader"),m.hideSkeletalRibbon&&h.removeElementById("SkeletalRibbon"),m.hideSkeletalNavPane&&h.removeElementById("SkeletalNavpane"),this.customizeSkeletalExperienceLayout()},e.customizeSkeletalExperienceLayout=function(){var t=h.getElement("SkeletalMainContent"),n=h.getElement("SkeletalExperience"),i=h.getElement("SkeletalRibbon");if(m.hideSkeletalHeader&&n&&(n.className+=" noHeader"),m.hideSkeletalRibbon&&n&&(n.className+=" noRibbon"),m.hideSkeletalNavPane&&n&&(n.className+=" noNavPane"),m.isViewMode?(n&&m.isCssPositionRewriteEnabled&&n.classList.remove("skeletalSLRGridRows"),i&&(i.innerHTML=""),m.isViewModeAndRibbonPanelSmall?(t&&!m.isCssPositionRewriteEnabled&&(t.style.top=m.isEmbedMode?"30px":"78px"),n&&m.isCssPositionRewriteEnabled&&(n.className+=" skeletalLegacyRibbonGridRows"),i&&!m.isCssPositionRewriteEnabled&&(i.className="skeletalRibbon skeletalRibbonCollapsedViewMode")):m.isViewModeAndRibbonPanelLarge?(i&&!m.isCssPositionRewriteEnabled&&(i.className="skeletalRibbon skeletalRibbonExpandedViewMode"),m.isCssPositionRewriteEnabled&&n?n.className+=" skeletalReadingRibbonGridRows":!m.isCssPositionRewriteEnabled&&t&&(t.style.top=m.isEmbedMode?"40px":"88px")):n&&m.isCssPositionRewriteEnabled&&(n.className+=" skeletalReadingRibbonGridRows")):n&&!m.isSimplifiedReactRibbonShown&&m.isCssPositionRewriteEnabled&&(m.isOldRibbonExpandedAndShown&&!m.isInTouchMode?n.className+=" skeletalLegacyRibbonMaximizedGridRows":m.isOldRibbonExpandedAndShown&&m.isInTouchMode?n.className+=" skeletalLegacyRibbonMaximizedTouchModeGridRows":m.isOldRibbonCollapsedAndShown&&(n.className+=" skeletalLegacyRibbonGridRows")),m.isSimplifiedReactRibbonShown?i&&(i.className=m.isCssPositionRewriteEnabled?"skeletalPositionRewriteRibbon":"skeletalSLRNewVisual"):i&&m.isCssPositionRewriteEnabled&&(i.className="skeletalPositionRewriteRibbon",m.isViewMode&&(i.className+=" viewMode")),m.isEmbedMode){i&&(m.isCssPositionRewriteEnabled||(i.style.top="0px"));var o=h.getElement("SkeletalAdditionOldRibbon");o&&!m.isCssPositionRewriteEnabled&&(o.style.top="0px")}if(this.isRtlMode()&&this.loadSkeletalInRTL(),m.isOldRibbonCollapsedAndShown?e.collapseSkeletalRibbon():m.isOldRibbonExpandedAndShown&&m.isEmbedMode&&t&&!m.isCssPositionRewriteEnabled&&(t.style.top="125px"),m.isTwoPaneNavEnabled&&!m.isEmbedMode){var a=h.getElement("SkeletalNavpane"),s=h.getElement("SkeletalNavpaneSectionColumn"),r=h.getElement("SkeletalNavpanePageColumn"),l=h.getElement("SkeletalCanvas"),c=h.getElement("SkeletalExperience");if(null!=a&&null!=s&&null!=r&&null!=l&&null!=c)if(this._clientWidth<=d.MinWidthForTwoPaneNav)m.isCssPositionRewriteEnabled?c.className+=" skeletalOreoTwopaneShrunkGridColumns":(a.style.width="300px",l.style.left="299px"),s.style.width="124px",r.style.width="124px";else if(this._clientWidth<=d.MinWidthToResizeTwoPaneNav){m.isCssPositionRewriteEnabled?c.style.gridTemplateColumns=this._clientWidth.toFixed()+"px 100%":(a.style.width=this._clientWidth.toFixed()+"px",l.style.left=this._clientWidth-1+"px");var u=.5*this._clientWidth-24;s.style.width=u.toFixed()+"px",r.style.width=u.toFixed()+"px"}}else if(m.isEmbedMode||this._clientWidth<=d.MinWidthToShowNavpane){h.removeElementById("SkeletalNavpane");l=h.getElement("SkeletalCanvas");var p=h.getElement("SkeletalExperience");m.isCssPositionRewriteEnabled&&p&&!m.hideSkeletalNavPane?m.isTwoPaneNavEnabled?p.className+=" skeletalNoTwopaneGridColumns":p.className+=" skeletalNoNavpaneGridColumns":!m.isCssPositionRewriteEnabled&&l&&(l.style.left="0px")}else if(this._clientWidth<=d.MinWidthToShowPageColumnPane){a=h.getElement("SkeletalNavpane");var b=h.getElement("SkeletalNotebookName"),f=(l=h.getElement("SkeletalCanvas"),h.getElement("SkeletalExperience"));h.removeElementById("SkeletalNavpaneSectionColumn"),h.removeElementById("skeletalNavpaneTab"),m.isCssPositionRewriteEnabled&&f?f.className+=" skeletalLegacyNavpanePageOnlyGridColumns":m.isCssPositionRewriteEnabled&&null!=a&&null!=l&&(a.style.width="201px",l.style.left="200px"),b&&(b.style.right="42px")}if(m.isSimplifiedReactRibbonShown&&null!=t)m.isCssPositionRewriteEnabled||(t.style.paddingTop=m.isEmbedMode?"74px":"126px",t.style.top="0px");else if(m.isOldRibbonCollapsedAndShown){var g=document.getElementsByClassName("skeletalRibbonBoxContainer").item(0),w=h.getElement("SkeletalRibbonBar");null!=t&&null!=w&&null!=g&&(h.removeElement(g),w.style.height="29px",w.style.borderBottom="1px solid #d2d2d2",m.isCssPositionRewriteEnabled||(t.style.top="0px"))}else if(m.isOldRibbonExpandedAndShown&&m.isInTouchMode){var v=h.getElement("SkeletalRibbonExtension");null==t||null==v||m.isCssPositionRewriteEnabled||(v.style.height="108px",t.style.top="187px")}},e.isRtlMode=function(){var e=h.getElement("SkeletalExperience");return null!=e&&"rtl"===e.getAttribute("direction")},e.loadSkeletalInRTL=function(){var e=["SkeletalHeader","SkeletalNewHeader","SkeletalRibbonAppTitle","SkeletalSLRAppTitle","SkeletalRibbon","SkeletalAdditionOldRibbon","SkeletalMainContent","SkeletalCanvas"];for(var t in e){var n=h.getElement(e[t]);n&&(n.className+=" skeletalRTL")}var i=h.getElement("SkeletalCanvas");i&&(i.className+=" skeletalCanvasRtl")},e.bringFastViewToForegroundOfSkeletalCanvas=function(){var e=h.getElement("WACFastView");e&&(e.style.position="initial")},e.removeAllSubunitsFromSkeletalCanvas=function(){var e=h.getElement("SkeletalCanvas");if(e)for(var t=e.children.length-1;t>=0;t-=1){var n=e.children.item(t);n&&"WACFastView"!==n.id&&e.removeChild(n)}},e.fadeOutAndRemoveElement=function(e,t){var n=h.getElement(e);n&&(n.style.background="transparent",n.style.opacity="0",n.className+=" skeletalCover",window.setTimeout((function(){h.removeElement(n),t&&t()}),d.HideAnimationTime))},e.setMainContentEditable=function(){if(!this._isMainContentEditable){this._isMainContentEditable=!0,this.fadeOutAndRemoveElement("SkeletalNavpane"),this.fadeOutAndRemoveElement("SkeletalMainContent");var e=document.getElementById("load_back");e&&(e.style.height="auto")}},e._clientWidth=0,e._isMainContentEditable=!1,e._ribbonPanelUpdated=!1,e}(),f=function(){function e(){}return e.launchExperience=function(t){m.initialize("false"===t.IsEditMode,"true"===t.IsEmbedMode,"true"===t.IsTeamsSession,"true"===t.SimplifiedReactRibbonUxIsEnabled,t.RibbonPreferenceCookieNameHint,t.IsSimplifiedRibbonOnCookieName,"true"===t.SnackbarNavPaneIsEnabled,"true"===t.OneNoteTwoPaneNavPaneIsEnabled,"true"===t.OneNoteCssPositionRewriteIsEnabled,"true"===t.HideHeaderEmbedded,"true"===t.HideRibbonEmbedded,"true"===t.ONHideNavEmbedded,"true"===t.MobileEmbedViewer),b.customizeSkeletalExperience(),this.showSkeletalUx(),window.setTimeout((function(){e.dismissSkeletalBootUx(!0)}),this.FORCE_DISMISS_AFTER)},e.showSkeletalUx=function(){var e=h.getElement("SkeletalExperience");e&&(e.style.opacity="1",e.className+=" skeletalShow")},e.setRibbonReady=function(){this._isExperienceEnded||(this._isRibbonReady=!0,!this.tryDismissSkeletalBootUxIfAllComponentsReady()&&this._isContentReady&&b.fadeOutAndRemoveElement("SkeletalRibbon"))},e.setPageReady=function(){this._isExperienceEnded||(b.updateRibbonPanel(),b.updateWacDocumentPanel(),this._isContentReady=!0,this.tryDismissSkeletalBootUxIfAllComponentsReady()||this.dismissSkeletalCanvas())},e.setNavpaneReady=function(){this._isExperienceEnded||(b.updateRibbonPanel(),this._isNavpaneReady=!0,!this.tryDismissSkeletalBootUxIfAllComponentsReady()&&this._isContentReady&&b.fadeOutAndRemoveElement("SkeletalNavpane",(function(){b.setMainContentEditable()})))},e.setFastViewReady=function(){this._isExperienceEnded||this.dismissSkeletalCanvas()},e.showFastViewOnSkeletalCanvas=function(){b.bringFastViewToForegroundOfSkeletalCanvas(),b.removeAllSubunitsFromSkeletalCanvas()},e.tryDismissSkeletalBootUxIfAllComponentsReady=function(){return!!(this._isContentReady&&this._isNavpaneReady&&this._isRibbonReady)&&this.dismissSkeletalBootUx()},e.dismissSkeletalBootUx=function(t){if(void 0===t&&(t=!1),this._isExperienceEnded)return!1;var n=document.getElementById("load_back"),i=document.getElementById("WACDocumentPanel"),o=document.getElementById("WACRibbonPanel");return n&&i&&o?(e.removeSkeletalExperience(),e.adjustElementsAfterSkeletalDismissal(n,i,o),this._isExperienceEnded=!0,!0):(t&&e.removeSkeletalExperience(),!1)},e.removeSkeletalExperience=function(){var e=h.getElement("SkeletalExperience");e&&h.removeElement(e)},e.adjustWacRibbonAfterDismissSkeletal=function(e){m.isCssPositionRewriteEnabled?this.adjustPositionRewriteWacRibbonAfterDismissSkeletal(e):this.adjustAbsoluteWacRibbonAfterDismissSkeletal(e)},e.adjustPositionRewriteWacRibbonAfterDismissSkeletal=function(e){e.style.height="auto"},e.adjustAbsoluteWacRibbonAfterDismissSkeletal=function(e){m.isSimplifiedReactRibbonShown?e.style.height="77px":e.style.height="auto"},e.adjustWacCanvasAfterDismissSkeletal=function(e){m.isCssPositionRewriteEnabled&&m.isSimplifiedReactRibbonShown||this.adjustAbsoluteWacCanvasAfterDismissSkeletal(e)},e.adjustAbsoluteWacCanvasAfterDismissSkeletal=function(e){e.className="SkeletalWacDocumentPanel skeletalEnabled "+e.className},e.dismissSkeletalCanvas=function(){var e=this,t=document.getElementById("WACFastView");if(!this._isExperienceEnded||t&&t.parentElement&&"SkeletalCanvas"===t.parentElement.id){this._isContentReady=!0;var n=document.getElementById("load_back");null!=n&&(this.preDismissSkeletalCanvas(n),b.fadeOutAndRemoveElement("SkeletalCanvas",(function(){e._isNavpaneReady&&b.setMainContentEditable()})))}},e.preDismissSkeletalCanvas=function(e){m.isCssPositionRewriteEnabled?this.preDismissPositionRewriteSkeletalCanvas(e):this.preDismissAbsoluteSkeletalCanvas(e)},e.preDismissPositionRewriteSkeletalCanvas=function(e){this.preDismissAbsoluteSkeletalCanvas(e)},e.preDismissAbsoluteSkeletalCanvas=function(e){var t=document.getElementById("WACRibbonPlaceholder"),n=h.getElement("SkeletalRibbonExtension");if(null!=t&&null!=n&&(t.style.height="124px"),e.style.background="transparent",b.isRtlMode()){var i=document.getElementById("application");i&&(i.style.minWidth="0px")}if(!m.isEmbedMode){var o=document.getElementById("AppHeaderPanel");o&&(o.style.height="48px")}},e.adjustElementsAfterSkeletalDismissal=function(e,t,n){e&&(e.style.display="none",e.style.height="1px",e.style.opacity="0",e.setAttribute("aria-hidden","true"),b.clearAriaLoadingAttributes()),t&&this.adjustWacCanvasAfterDismissSkeletal(t),n&&this.adjustWacRibbonAfterDismissSkeletal(n)},e._isRibbonReady=!1,e._isContentReady=!1,e._isNavpaneReady=!1,e._isExperienceEnded=!1,e.FORCE_DISMISS_AFTER=2e4,e}(),g=function(){function e(){}return e.browserSupportsPerformanceMarkAndMeasure=function(){return!!(window&&window.performance&&window.performance.mark&&window.performance.measure)},e.addMark=function(t){e.browserSupportsPerformanceMarkAndMeasure()&&window.performance.mark(t)},e.measureMarks=function(t,n,i){if(e.browserSupportsPerformanceMarkAndMeasure())try{window.performance.measure(t,n,i)}catch(e){}},e.measureNetworkType=function(){if(window&&window.navigator){var e=window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection;if(e)return e.effectiveType}},e.getEntry=function(t,n){if(e.browserSupportsPerformanceMarkAndMeasure())try{var i=window.performance.getEntriesByName(t,n);if(i.length>0)return i[0]}catch(e){}},e.sendBeacon=function(e,t){window._bB&&window._bB.sendBeacon(e,t)},e}(),w=function(){function e(){}return e.getFloatingObjectsContainerWidth=function(){return e.CanvasAndFcOuterSurfaceOffset+e.FloatingContainersOuterSurfaceWidth},e.shouldShiftFastView=function(t,n,i){return e.shouldShiftBasedOnScreenSize(i)&&e.shouldShiftBasedOnNumSections(n)&&t},e.shouldShiftRealCanvas=function(t,n,i,o,a){if(!e.shouldShiftBasedOnScreenSize(t))return!1;var s=n(i);return!!e.shouldShiftBasedOnNumSections(s)&&o(a)},e.shouldShiftBasedOnScreenSize=function(e){return"Small"!==e},e.shouldShiftBasedOnNumSections=function(e){return 1===e},e.CanvasAndFcOuterSurfaceOffset=30,e.FloatingContainersOuterSurfaceWidth=240,e}(),v=function(){this.positionAbsolute=!1,this.showRibbon=!1,this.showRibbonHeader=!0,this.showRibbonImage=!1,this.showNavPane=!1,this.showNavSections=!0,this.ribbonExpandedByDefault=!1,this.ribbonPreferenceCookieName="",this.ribbonImageBase="",this.appBrandedName="",this.shouldStretchPageToBottom=!1,this.editable=!1,this.pasteLoadingUI=!1,this.loadingUIGif="",this.simplifiedReactRibbonUxIsEnabled=!1,this.simplifiedReactRibbonAnimationIsEnabled=!1,this.skeletalBootUXIsEnabled=!1,this.snackbarNavPaneIsEnabled=!1,this.twoPaneNavIsEnabled=!1,this.reactSharedHeaderIsEnabled=!1,this.headerAppLauncherIsHidden=!1,this.headerBackgroundColorOverride="",this.headerTextColorOverride="",this.cssPositionRewriteIsEnabled=!1,this.wordIsSkeletalDeepLinkOn=!1,this.isDeepLinkScenario=!1,this.reactMultiLineRibbonIsVisible=!1,this.renderFastViewOnSkeletalUXIsEnabled=!1,this.isRegionComposerShown=!1,this.appColorUpdateIsEnabled=!1,this.isRtl=!1,this.preventCanvasShiftOnBootIsEnabled=!1,this.headerBootSettings=void 0},S=function(e,t){this.eventName=e,this.timeStamp=(new Date).getTime()-t},y=function(){function e(e,t,n,i,o,a,s,r,l){void 0===o&&(o="Default"),void 0===a&&(a=p.getCookie),void 0===s&&(s=!1),void 0===r&&(r=!1),void 0===l&&(l=0),this.getTopbarContainerFunc=e,this.getRibbonContainerFunc=t,this.getDocumentContainerFunc=n,this.appearance=i,this.entry=o,this.getCookieFunc=a,this.fastViewOnSkeletal=s,this.hasUnresolvedComments=r,this.numSections=l,this.touchSupport=this.isTouchSupport(),this.eventLogs=[],this.openTime=0}return e.prototype.handleKeyboardEvent=function(e){"Shift"!==e.key&&"Control"!==e.key&&"Alt"!==e.key&&this.logEventData(e.type)},e.prototype.handleEditableKeyboardEvent=function(e){(13===e.keyCode||e.ctrlKey&&(66===e.keyCode||73===e.keyCode||85===e.keyCode))&&(e.preventDefault(),this.logEventData(e.key))},e.prototype.handlePasteEvent=function(e){if(void 0!==this.isEditable&&void 0!==this.htmlElement&&void 0!==this.editableSpan&&this.isEditable&&this.appearance.pasteLoadingUI&&!this.isPasteLoading&&this.htmlElement.parentElement){this.isPasteLoading=!0;var t=function(e){var t=document.createElement("div");t.id="WACLoadingPasteUI";var n=document.createElement("div");n.className="WACFastLoadingBoxUI";var i,o=document.createElement("img");return o.src=e,o.className="WACProgressIcon",n.appendChild(o),t.appendChild(n),t.appendChild(((i=document.createElement("div")).className="WACFastLoadingOverlay WACDialogOverlay",i)),t.setAttribute("aria-busy","true"),t.setAttribute("role","progressbar"),t}(this.appearance.loadingUIGif);this.htmlElement.parentElement.appendChild(t),this.pasteData=function(e){var t={};if(null!=e&&null!=e.types){var n=e.types[0];t.type=n,t.data=e.getData(n)}else{var i=window.clipboardData,o=i.getData("text");null!==o?(t.type="text/plain",t.data=o):i.files.length>0&&(t.type="image/png",t.data=i.files[0])}return t}(e.clipboardData),this.editableSpan.removeAttribute("contentEditable"),e.preventDefault()}else this.blockEvent(e)},e.prototype.blockEvent=function(e){this.logEventData(e.type),e.preventDefault()},e.prototype.logEventData=function(e){this.eventLogs&&this.openTime&&this.eventLogs.push(new S(e,this.openTime))},e.prototype.logEvent=function(e){this.logEventData(e.type)},e.prototype.handleEditableMousedownEvent=function(e){if(this.logEventData(e.type),this.editableSpan&&e.target!==this.editableSpan){if(this.editableSpan.focus(),window.getSelection){var t=window.getSelection();t&&t.collapseToEnd()}e.preventDefault()}},e.prototype.removeKeypressEventListener=function(){this.keyboardEventHandler&&document.removeEventListener("keydown",this.keyboardEventHandler)},e.prototype.isTouchSupport=function(){function e(){return navigator.userAgent.indexOf("iPad")>=0||navigator.userAgent.indexOf("Macintosh")>=0&&t()&&!(navigator.userAgent.indexOf("iPhone")>=0)}function t(){return navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0}return navigator.userAgent.indexOf("Android")>=0||e()||t()},e.prototype.showRibbonPlaceholder=function(){var e=this;function t(e,t){var n=document.createElement("div");return n.className="ribbonBar",n.setAttribute("unselectable","on"),n.appendChild(e),n.appendChild(t),n}if(!document.getElementById("ExternalHeaderFullTopBars")){var n=s(),i=this.getTopbarContainerFunc();if(i&&this.appearance.showRibbonHeader)if(n&&this.appearance.headerBootSettings){(o=document.createElement("div")).className="cui-topBar1-transitionalReactHeaderUI",o.id="o365headerJsFastViewContainer",o.setAttribute("style","height:48px"),i.appendChild(o),n(o,this.appearance.headerBootSettings)}else{var o=function(){var t=document.createElement("div");t.className="cui-topBar1",e.appearance.reactSharedHeaderIsEnabled?t.className+=" cui-topBar1-transitionalReactHeaderUI":t.className+=" cui-topBar1-transistionalHeaderUI",t.setAttribute("unselectable","on");var n="",i="";e.appearance.headerBackgroundColorOverride&&(n="background-color:"+e.appearance.headerBackgroundColorOverride+";"),e.appearance.headerTextColorOverride&&(i="color:"+e.appearance.headerTextColorOverride+";"),e.appearance.reactSharedHeaderIsEnabled&&(n||i)&&t.setAttribute("style",""+n+i);var o=document.createElement("span");o.className="cui-QATRowLeft BreadcrumbContainer";var a=document.createElement("span");a.className="AppAndBrandContainer",e.appearance.reactSharedHeaderIsEnabled&&n&&a.setAttribute("style",n);var s=document.createElement("div");s.className="WACFastBootLoader";var r=document.createElement("span");r.className="BreadcrumbItem";var l=e.appearance.reactSharedHeaderIsEnabled&&e.appearance.headerAppLauncherIsHidden;l?r.setAttribute("style","width:8px;height:48px;display:inline-block;"):r.setAttribute("style","width:48px;height:48px;display:inline-block;"),document.createElement("span").className="OfficeOnlineBrandSwitcherSeparator";var d=document.createElement("span");return d.className="headBrand",e.appearance.reactSharedHeaderIsEnabled?d.setAttribute("style","line-height:48px;margin-left:2px;"):d.setAttribute("style","line-height:48px;"),d.appendChild(document.createTextNode(e.appearance.appBrandedName)),a.appendChild(r),a.appendChild(d),l||a.appendChild(s),o.appendChild(a),t.appendChild(o),e.appearance.appColorUpdateIsEnabled&&(t.className+=" cui-color-update",a.className+=" cui-color-update"),t}(),a=document.createElement("div");a.className="cui-topBar2",a.setAttribute("unselectable","on");var r=document.createElement("div");r.id="WACTopbarPlaceholder",r.appendChild(o),r.appendChild(a),i.appendChild(r),this.topbarPlaceholderElement=r}var l=this.getRibbonContainerFunc();if(l&&0===l.children.length){var d=document.createElement("div");if(d.id="WACRibbonPlaceholder",d.className=d.id,this.appearance.showRibbon&&!this.appearance.skeletalBootUXIsEnabled)if(this.appearance.simplifiedReactRibbonUxIsEnabled)(c=function(e,n){var i=document.createElement("div");i.className=e?"oneLineRibbonUpperWithAnimation":"oneLineRibbonUpper",i.className+=" oneLineRibbonUpperWithTabHeaderRefresh";var o=document.createElement("div");return o.className=e?"oneLineRibbonLowerWithAnimation":"oneLineRibbonLower",n&&(o.style.height="90px"),t(i,o)}(this.appearance.simplifiedReactRibbonAnimationIsEnabled,this.appearance.reactMultiLineRibbonIsVisible)).addEventListener("click",(function(){e.logEventData("ribbonClick")})),d.appendChild(c);else if(this.appearance.showRibbonImage&&this.appearance.ribbonExpandedByDefault&&"true"!==this.getCookieFunc(this.appearance.ribbonPreferenceCookieName)){var c;(c=function(e,n){var i=document.createElement("div");i.className="ribbonUpper";var o=document.createElement("div");o.className="ribbonLower";var a=document.createElement("div");a.className="ribbonLeft";var s=function(e,t){var n=t;if(e){n=t.replace("bgapp_word_topleft","bgapp_word_topleft_touch")}return n}(e,n);return a.style.backgroundImage="url('"+s+"')",e&&(o.className+=" ribbonTouch",a.className+=" ribbonTouch"),i.appendChild(a),t(i,o)}(this.touchSupport,this.appearance.ribbonImageBase)).addEventListener("click",(function(){e.logEventData("ribbonClick")})),d.appendChild(c)}else d.style.height="30px";else d.className="cui-exth";l.appendChild(d),this.ribbonPlaceholderElement=d}}},e.prototype.makeInitialParaEditable=function(e){var t=this,n=e.querySelector(".PageContentContainer");n&&(n.className+=" WACFastViewEditor",n.addEventListener("mousedown",(function(e){t.handleEditableMousedownEvent(e)}))),this.editableSpan=e.querySelector(".NormalTextRun"),this.editableSpan&&(this.editableSpan.contentEditable="true",this.editableSpan.style.outline="0px",this.editableSpan.spellcheck=!1,this.editableSpan.setAttribute("aria-hidden","true"),this.editableSpan.focus(),this.editableSpan.addEventListener("paste",(function(e){t.handlePasteEvent(e)})),this.editableSpan.addEventListener("keydown",(function(e){t.handleEditableKeyboardEvent(e)})))},e.prototype.sendBeaconForBoot=function(e){g.sendBeacon(e,"BootPhaseCompleted")},e.prototype.open=function(t,n){var i=this;void 0===n&&(n=!1),this.appearance.showRibbonHeader||this.makeStyleChangesToHideHeader(),this.showRibbonPlaceholderIfRequired();var o=this.getDocumentContainerFunc();if(!o||!t)return!1;var a="canvasWrap"===o.id,s=document.createElement("div"),l=function(t,n,i,o){var a;if(a=t.cssPositionRewriteIsEnabled&&!o?e.cssPositionRewriteClass:e.cssClass,t.wordIsSkeletalDeepLinkOn&&t.isDeepLinkScenario&&(a+=" Deeplink"),t.showRibbon||(a+=" HideRibbon"),t.showNavPane||(a+=" HideNavPane"),t.positionAbsolute){if(a+=" "+e.cssClassAbsolute,t.showRibbon?t.showRibbonHeader||(a+=" HeaderHidden"):a+=" HeaderAndRibbonHidden",t.showNavPane?t.showNavSections||(a+=" SectionsHidden"):a+=" NavHidden",t.simplifiedReactRibbonUxIsEnabled)a+=" OneLineRibbon",a+=" OneLineRibbonWithTabHeaderRefresh";else{var s=n(t.ribbonPreferenceCookieName);(!t.ribbonExpandedByDefault&&"false"===s||t.ribbonExpandedByDefault&&"true"!==s)&&(a+=" RibbonPinned",i&&(a+=" Touch"))}t.skeletalBootUXIsEnabled&&(a+=" "+b.getFastViewSkeletalClass()),t.snackbarNavPaneIsEnabled&&(a+=" Snackbar"),t.twoPaneNavIsEnabled&&(a+=" TwoPaneNav")}return a}(this.appearance,this.getCookieFunc,this.touchSupport,a);if(this.appearance.isRegionComposerShown&&(l+=" WACFastViewRegionComposer"),this.appearance.reactMultiLineRibbonIsVisible&&(l+=" WACFastViewMLRVisible"),s.className=l,s.id="WACFastView",s.innerHTML=t,this.htmlElement=s,this.appearance.editable&&(this.isEditable=p.isDocumentEmpty(s)),n)s.style.visibility="hidden";else{this.keyboardEventHandler=this.handleKeyboardEvent,document.addEventListener("keydown",(function(e){i.keyboardEventHandler&&i.keyboardEventHandler(e)}));var d=function(e){i.logEvent(e)};if(s.firstChild)if(s.firstChild.addEventListener("scroll",d),s.firstChild.addEventListener("click",d),s.firstChild.addEventListener("dblclick",d),s.firstChild.addEventListener("contextmenu",(function(e){i.blockEvent(e)})),a)s.firstChild.classList.add("WACFastViewNavOreoGrid");this.appearance.preventCanvasShiftOnBootIsEnabled&&(w.shouldShiftFastView(this.hasUnresolvedComments,this.numSections,r.getLayoutBreakpoint())?(this.logEventData("Shifting Fast View"),this.shiftCanvas(s)):this.logEventData("Not shifting Fast View"),this.logEventData("HasUnresolvedComments: "+this.hasUnresolvedComments+", NumSections == 1: "+(1===this.numSections)+", ScreenSize == Small: "+("Small"===r.getLayoutBreakpoint()))),o.appendChild(s),navigator.userAgent.indexOf("Macintosh")>=0&&document.body.classList.add("Mac"),this.appearance.wordIsSkeletalDeepLinkOn&&this.appearance.isDeepLinkScenario&&document.body.classList.add("Deeplink"),this.fastViewOnSkeletal?f.showFastViewOnSkeletalCanvas():c.g_isUserCreatingPersonalNotebookFirstTime||(this.appearance.skeletalBootUXIsEnabled?f.setFastViewReady():function(){var e=document.getElementById("load_img");e&&(e.style.opacity="0",e.style.height="1px");var t=document.getElementById("load_back");t&&(t.style.opacity="0",t.style.height="1px")}()),function(e,t){if(!(t.wordIsSkeletalDeepLinkOn&&t.isDeepLinkScenario||0===u.initialParaId)){var n=document.querySelector("p[paraid='"+u.initialParaId+"']");if(!n||!n.getBoundingClientRect)return;var i=n.getBoundingClientRect().bottom,o=e.getBoundingClientRect().bottom;e.firstElementChild&&(e.firstElementChild.scrollTop=i-o+70)}}(s,this.appearance),this.sendBeaconForBoot("RecordContentDisplayed"),this.isEditable&&(s.className+=" WACFastViewEditable",this.makeInitialParaEditable(s),this.sendBeaconForBoot("RecordAppInteractive"))}return this.openTime=(new Date).getTime(),g.addMark("ViewableEnd"),g.measureMarks("Viewable","StartWacBoot","ViewableEnd"),!0},e.prototype.shiftCanvas=function(e){if(null!=e){var t=e.querySelector(".OutlineContainer"),n=e.querySelector(".PageContentContainer");if(null!=t&&null!=n){var i=document.createElement("div"),o=w.getFloatingObjectsContainerWidth()+"px";this.appearance.isRtl?i.style.paddingLeft=o:i.style.paddingRight=o,n.appendChild(i),i.appendChild(t)}}},e.prototype.showRibbonPlaceholderIfRequired=function(){this.appearance.positionAbsolute&&this.appearance.showRibbon&&!this.ribbonPlaceholderShown&&!this.appearance.skeletalBootUXIsEnabled&&(this.showRibbonPlaceholder(),this.ribbonPlaceholderShown=!0)},e.prototype.makeStyleChangesToHideHeader=function(){var e=document.getElementById("application");e&&(e.style.top="0")},e.prototype.isOpen=function(){return!(!this.htmlElement||!this.htmlElement.parentNode)},e.cssClassAbsolute="WACFastViewAbsolute",e.cssClass="WACFastView",e.cssPositionRewriteClass="WACFastViewPositionRewrite",e}(),C=function(){function e(){}return e.initialize=function(t){e.skeletalDeepLinkShouldBeOn=t,e.isInitialized||(e.isInitialized=!0,e.skeletalContainer=document.createElement("div"),e.skeletalContainer.setAttribute("unselectable","on"),e.skeletalContainer.style.pointerEvents="none",e.skeletalContainer.style.width="100%",e.skeletalContainer.style.height="100%",e.skeletalContainer.style.zIndex="1000",e.skeletalContainer.style.position="absolute",e.skeletalContainer.style.visibility="hidden",e.skeletalContainer.style.transition="opacity "+e.hideAnimationTime+"ms",e.skeletalContainer.id=e.skeletalContainerId,e.skeletalContainer.className=e.skeletalContainer.id)},e.launchExperience=function(t,n){var i="applicationOuterContainer";t&&(i=t),n&&(e.failureDismissTime=n),document.getElementById(i).appendChild(e.skeletalContainer),e.showSkeletalUx(),window.setTimeout((function(){return e.dismissSkeletalBootUx()}),e.failureDismissTime)},e.showSkeletalUx=function(){e.skeletalContainer&&(e.skeletalContainer.style.visibility="visible",e.skeletalContainer.style.opacity="1")},e.areAllSkeletalComponentsReady=function(){for(var t in e.skeletalComponents)if(!e.skeletalComponents[t].isReady)return!1;return!0},e.setComponentReady=function(t){var n=e.getComponent(t);!e.isExperienceEnded&&n&&(n.isReady=!0,e.tryDismissSkeletalBootUxIfAllComponentsReady()||e.fadeOutAndRemove(t))},e.tryDismissSkeletalBootUxIfAllComponentsReady=function(){return!!e.areAllSkeletalComponentsReady()&&e.dismissSkeletalBootUx()},e.dismissSkeletalBootUx=function(){if(e.isExperienceEnded)return!1;for(var t in e.fadeOutAndRemove(e.skeletalContainerId),e.skeletalComponents)e.fadeOutAndRemove(t);return e.skeletalComponents={},e.isExperienceEnded=!0,!0},e.getSkeletalComponentColor=function(){return e.skeletalComponentColor},e.addComponent=function(t){e.skeletalComponents[t.element.id]=t,t.element.style.transition="opacity "+e.hideAnimationTime+"ms",e.skeletalContainer.appendChild(t.element)},e.addComponentOutsideSkeletalContainer=function(t){e.skeletalComponents[t.element.id]=t,t.element.style.transition="opacity "+e.hideAnimationTime+"ms"},e.registerSkeletalShimmerAnimation=function(){if(!e.skeletalShimmerAnimationRegistered){var t=document.createElement("style");t.type="text/css";t.appendChild(document.createTextNode("@keyframes SkeletalShimmer {       100% { -webkit-transform: rotate(0.06deg); transform: rotate(0.06deg); }      }")),document.getElementsByTagName("head")[0].appendChild(t),e.skeletalShimmerAnimationRegistered=!0}},e.addShimmerToElement=function(e){if(!Object(r.isReducedAnimations)()){var t=document.getElementById(e);if(t){this.registerSkeletalShimmerAnimation();var n=document.createElement("div");n.id=e+"_Shimmer",n.style.height="200px",n.style.top="-200px",n.style.width="100000%",n.style.left="-99900%",n.style.backgroundColor="linear-gradient(rgba(255,255,255, 0), rgba(255,255,255,.4), rgba(255,255,255,.8), rgba(255,255,255,.4), rgba(255,255,255,0))",n.style.position="absolute",n.style.transformOrigin="left",n.style.zIndex="1000",n.style.animation="SkeletalShimmer 3s infinite linear",t.appendChild(n)}}},e.getComponent=function(t){return e.skeletalComponents[t]},e.removeComponent=function(t){delete e.skeletalComponents[t]},e.fadeOutAndRemove=function(t,n){var i=void 0,o=void 0;t===e.skeletalContainerId?i=e.skeletalContainer:(o=e.getComponent(t))&&(i=o.element),i&&(i.style.opacity="0",window.setTimeout((function(){e.removeElement(i),o&&e.removeComponent(t),n&&n()}),e.hideAnimationTime))},e.removeElement=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},e.isSkeletalDeepLink=function(){return e.skeletalDeepLinkShouldBeOn},e.isInitialized=!1,e.isExperienceEnded=!1,e.failureDismissTime=3e4,e.skeletalContainerId="SkeletalContainer",e.hideAnimationTime=Object(r.isReducedAnimations)()?.001:200,e.skeletalComponents={},e.skeletalComponentColor="#EDEBE9",e.skeletalDeepLinkShouldBeOn=!1,e.skeletalShimmerAnimationRegistered=!1,e}(),R=function(){function e(){}return e.initialize=function(){this.metrics={initialVisibility:document.visibilityState,initializeTime:new Date,events:[]},document.addEventListener("visibilitychange",e.handleVisibilityChange)},e.stop=function(){document.removeEventListener("visibilitychange",this.handleVisibilityChange)},e.handleVisibilityChange=function(){var t={visibility:document.visibilityState,time:new Date};e.metrics.events.push(t)},e}();R.initialize();var E,k=function(){function e(t,n,i,o,a,s){this.fastBootEnabled="true"===a.FastBoot,e.slice0Name=a.Slice0Name,this.appearance={positionAbsolute:!("true"===a.OneNoteCssPositionRewriteIsEnabled&&e.isSimplifiedReactRibbonUxEnabled(a)),showRibbon:!("true"===a.HideRibbonEmbedded),ribbonExpandedByDefault:t,ribbonPreferenceCookieName:a.RibbonPreferenceCookieNameHint,showRibbonImage:n,ribbonImageBase:a.RibbonImageBase,shouldStretchPageToBottom:i,appBrandedName:a.BrandedWebAppName,showRibbonHeader:!("true"===a.HideHeaderEmbedded),showNavPane:o&&!("true"===a.ONHideNavEmbedded),showNavSections:!("true"===a.ONHideSectionsEmbedded),editable:!1,pasteLoadingUI:"true"===a.PasteInBootLoadingUIIsEnabled,loadingUIGif:a.ProgressGifResource,simplifiedReactRibbonUxIsEnabled:e.isSimplifiedReactRibbonUxEnabled(a),simplifiedReactRibbonAnimationIsEnabled:e.isSimplifiedReactRibbonAnimationEnabled(a),skeletalBootUXIsEnabled:"true"===a.OneNoteSkeletalBootUXIsEnabled,snackbarNavPaneIsEnabled:"true"===a.SnackbarNavPaneIsEnabled,twoPaneNavIsEnabled:"true"===a.OneNoteTwoPaneNavPaneIsEnabled,reactSharedHeaderIsEnabled:"true"===a.ReactSharedHeaderIsEnabled,headerAppLauncherIsHidden:"true"===a.AppLauncherIsHidden,headerBackgroundColorOverride:decodeURIComponent(p.getCookie("ThemedHeaderBackgroundColor")),headerTextColorOverride:decodeURIComponent(p.getCookie("ThemedHeaderTextColor")),cssPositionRewriteIsEnabled:"true"===a.OneNoteCssPositionRewriteIsEnabled&&e.isSimplifiedReactRibbonUxEnabled(a),wordIsSkeletalDeepLinkOn:"true"===a.WordIsSkeletalDeepLinkOn,isDeepLinkScenario:"true"===a.IsDeepLinkScenario,reactMultiLineRibbonIsVisible:e.isReactMultilineRibbonVisible(a),renderFastViewOnSkeletalUXIsEnabled:"true"===a.OneNoteRenderFastViewOnSkeletalIsEnabled,isRegionComposerShown:!!s,appColorUpdateIsEnabled:"true"===a.AppColorUpdateIsEnabled,isRtl:"true"===a.Rtl,preventCanvasShiftOnBootIsEnabled:"true"===a.PreventCanvasShiftOnBootIsEnabled,headerBootSettings:a.HeaderBootSettings}}return e.prototype.launchFastView=function(e,t,n,i,o,a){if(void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===o&&(o=!1),void 0===a&&(a=0),g.sendBeacon("Launching FastView from entry point "+t,"BootLogs"),this.appearance.editable=n,this.fastBootEnabled&&!u.fastView&&!document.getElementById("PageContentContainer")){var s,r=document.getElementById("canvasWrap");if(null!=r&&this.appearance.cssPositionRewriteIsEnabled)s=r;else{var l=this.appearance.renderFastViewOnSkeletalUXIsEnabled&&i?"SkeletalCanvas":"WACInnerFrame";s=document.getElementById(l)}u.fastView=new y((function(){return document.getElementById("AppHeaderPanel")}),(function(){return document.getElementById("WACRibbonPanel")}),(function(){return s}),this.appearance,t,p.getCookie,i,o,a);try{return u.fastView.open(e)}catch(e){return u.fastBootError="FastView open failed: "+e.message+"\r\n"+e.stack,!1}}return!1},e.getSlice0=function(){if(null!=e.slice0Name&&e.slice0Name.length>0){var t=document.createElement("script");t.type="text/javascript",t.src=e.slice0Name,document.getElementsByTagName("head")[0].appendChild(t)}},e.isSimplifiedReactRibbonUxEnabled=function(t){return"true"===t.SimplifiedReactRibbonUxIsEnabled&&e.userDidNotOptOutOfSimplifiedUX(t)},e.isSimplifiedReactRibbonAnimationEnabled=function(t){return"true"===t.OneLineRibbonAnimationIsEnabled&&e.isSimplifiedReactRibbonUxEnabled(t)},e.userDidNotOptOutOfSimplifiedUX=function(e){return"false"===e.OptOutSupportForSimplifiedRibbonIsEnabled||"false"!==p.getCookie(e.IsSimplifiedRibbonOnCookieName).toLowerCase()},e.isReactMultilineRibbonVisible=function(t){return"true"===t.ReactMultilineRibbonIsEnabled&&(e.userHasMLRPreference(t)||"false"===p.getCookie(t.IsSimplifiedRibbonOnCookieName).toLowerCase())},e.userHasMLRPreference=function(e){return"true"===p.getCookie(e.ReactRibbonMLRPreferenceCookieName).toLowerCase()},e}(),P=function(e,t,n,i){void 0===n&&(n=!1),void 0===i&&(i=1),this.pageHtml=e,this.editable=t,this.hasUnresolvedComments=n,this.numSections=i},O=function(){function e(){}return e.getPageHtmlInfoFromGetCellsResponse=function(e,t){if(void 0===t&&(t=!1),e&&e.Responses[0]&&e.Responses[0][1]&&e.Responses[0][1].Cells)for(var n=e.Responses[0][1].Cells,i=0;i<n.length;i+=1){var o=n[i];if(o&&o.PageHtml)return t?new P(o.PageHtml,!!o.IsPageHtmlEditable,!!o.HasUnresolvedComments,o.NumSections):new P(o.PageHtml,!!o.IsPageHtmlEditable)}},e}(),I=function(){function e(t,n){var i=this;this.onGetCellsRequestCompleted=function(t){if(g.sendBeacon("Get cells response received:"+t.status,"BootLogs"),!c.g_initialRequestCompleted){if(e.onGetCellsRequestCompletedInternal(t.responseText,!1),!u.fastView){var n=O.getPageHtmlInfoFromGetCellsResponse(c.g_initialRequestResponseObject,i.wacBootOptions.preventCanvasShiftOnBootIsEnabled);n&&n.pageHtml&&i.fastViewFactory&&i.fastViewFactory.launchFastView(n.pageHtml,"WacBootGetCells",n.editable,!1,n.hasUnresolvedComments,n.numSections)}c.g_fastViewOpenTime=new Date}},this.onInitialResponseReady=function(){c.g_onInitialResponseReady&&c.g_onInitialResponseReady()},this.onRenderPageRequestCompleted=function(t){var n=t.responseText;if(!u.fastView){var o=function(t){var n=e.getResponseFromText(t);if(n&&n.Responses[0]&&n.Responses[0][1]&&n.Responses[0][1].Html)return n.Responses[0][1].Html}(n);o&&i.fastViewFactory&&i.fastViewFactory.launchFastView(o,"WacBootRenderPage")}},this.fastViewFactory=t,this.wacBootOptions=n}return e.prototype.makeGetCellsRequest=function(e){g.sendBeacon("Making GetCells Request","BootLogs"),u.initialParaId=this.wacBootOptions.initParagraphId||0;var t=JSON.stringify(window.location.href),n=',"SearchQuery":null,"IsNewFile":'+(this.wacBootOptions.isNewFile&&this.wacBootOptions.optimizedForNewFile).toString()+',"InitialParaId":'+u.initialParaId+',"RequestUrl":'+t+',"SkipPageHtmlInResponse":'+this.wacBootOptions.skipPageHtmlInGetCellsResponse.toString(),i=this.getRequestBody(1,n,{}),o=this.wacBootOptions.requestOptions.url+"OneNote.ashx";return this.makeRequest(o,i,e,this.setGetCellsRequestGlobals)},e.prototype.makeRenderPageRequest=function(e){if(!this.wacBootOptions.isNewFile||!this.wacBootOptions.optimizedForNewFile){var t=this.getRequestBody(46,"",e),n=this.wacBootOptions.requestOptions.url+"OneNote.ashx?IsRenderPage=1";this.makeRequest(n,t,this.onRenderPageRequestCompleted,(function(){}))}},e.prototype.makeStartSessionRequest=function(e,t){var n=this.wacBootOptions.requestOptions.url+e;this.makeRequest(n,"",t,(function(){}))},e.prototype.setGetCellsRequestGlobals=function(){c.g_initialRequestInvokedTime=new Date,c.g_initialRequestMade=!0,g.addMark("InitialRequestStart")},e.prototype.makeRequest=function(e,t,n,i){var o=new XMLHttpRequest,a={};for(var s in o.onreadystatechange=function(){if(o&&4===o.readyState){if(void 0===o.status||0===o.status)return;try{n&&n(o)}finally{null!=o&&(o.onreadystatechange=function(){},o=void 0)}}},o.open("Post",e,!0),this.buildRequestHeaderDict(a),a)o.setRequestHeader(s,a[s]);var r=t;return t||(r=""),i(),o.send(r),o},e.prototype.buildRequestHeaderDict=function(e){e["X-xhr"]="1",this.wacBootOptions.requestOptions.userSessionId&&(e["X-UserSessionId"]=this.wacBootOptions.requestOptions.userSessionId),this.wacBootOptions.requestOptions.buildVersion&&(e["X-OfficeVersion"]=this.wacBootOptions.requestOptions.buildVersion),e["Content-Type"]="application/json; charset=utf-8",this.wacBootOptions.requestOptions.canary&&(e["X-Key"]=this.wacBootOptions.requestOptions.canary),this.wacBootOptions.requestOptions.accessToken&&(e["X-AccessToken"]=this.wacBootOptions.requestOptions.accessToken),this.wacBootOptions.requestOptions.accessTokenTtl&&(e["X-AccessTokenTtl"]=this.wacBootOptions.requestOptions.accessTokenTtl),this.wacBootOptions.requestOptions.userType&&(e["X-UserType"]=this.wacBootOptions.requestOptions.userType),1===this.wacBootOptions.requestOptions.logHostRequests&&(e["X-LogHostRequests"]="1"),this.wacBootOptions.requestOptions.wacCluster&&(e["X-WacCluster"]=this.wacBootOptions.requestOptions.wacCluster),this.wacBootOptions.requestOptions.wacUserAgent&&(e["X-WacUserAgent"]=this.wacBootOptions.requestOptions.wacUserAgent),this.wacBootOptions.requestOptions.renderingMode&&(e["X-ServerSideRendering"]=this.wacBootOptions.requestOptions.renderingMode),this.wacBootOptions.requestOptions.feMachineId&&(e["X-FEMachineId"]=this.wacBootOptions.requestOptions.feMachineId),this.wacBootOptions.sessionStartJson&&(e["X-SessionStartDimensions"]=this.wacBootOptions.sessionStartJson),e["X-Requested-With"]="XMLHttpRequest"},e.prototype.getRequestBody=function(e,t,n){var i=JSON.stringify(this.wacBootOptions.requestOptions.rootQuerySignature);i&&(i=i.substring(1,i.length-1));var o=JSON.stringify(this.wacBootOptions.requestOptions.pageTarget);o&&(o=o.substring(1,o.length-1));var a='{"Mode":'+this.wacBootOptions.requestOptions.requestHeadMode+',"srs":[[',s=',{"FileId":"'+i+'","PageTarget":"'+o+'","OperationId":1';for(var r in n)s+=',"'+r+'":'+n[r];return a+e+s+t+"}]]}"},e.getResponseFromText=function(e){try{return JSON.parse(e)}catch(e){u.fastBootError="JSON.parse failed: "+e.message+"\r\n"+e.stack}},e.onGetCellsRequestCompletedInternal=function(t,n){c.g_getCellsFromFrameRequest=n,c.g_initialRequestCompleted=!0,c.g_initialResponseTime=new Date,g.addMark("InitialRequestEnd"),g.addMark("InitialResponseProcessStart"),g.measureMarks("InitialRequest","InitialRequestStart","InitialRequestEnd");var i=e.getResponseFromText(t);if(c.g_initialRequestResponseObject=i,i&&i.Responses&&i.Responses[0]&&i.Responses[0][1]){var o=i.Responses[0][1];c.g_acquireLockStartTime=o.AcquireLockStartTime,c.g_acquireLockEndTime=o.AcquireLockEndTime,c.g_acquireLockRequestStatus=o.AcquireLockRequestStatus,c.g_getDocumentStartTime=o.GetDocumentStartTime,c.g_getDocumentEndTime=o.GetDocumentEndTime,c.g_getDocumentRequestStatus=o.GetDocumentrequestStatus,c.g_getCellsStartTime=o.GetCellsStartTime,c.g_getCellsEndTime=o.GetCellsEndTime,c.g_getInitializeLocalCobaltStartTime=o.InitializeLocalCobaltStartTime,c.g_getInitializeLocalCobaltEndTime=o.InitializeLocalCobaltEndTime}c.g_initialResponseReadyTime=new Date,g.addMark("InitialResponseProcessEnd"),g.measureMarks("InitialResponseProcess","InitialResponseProcessStart","InitialResponseProcessEnd")},e.getCellsFromFrameRequest=function(t){c.g_initialRequestCompleted||(e.onGetCellsRequestCompletedInternal(t,!0),c.g_fastViewOpenTime=new Date)},e}(),A=function(){function e(){}return e.createRequestOptions=function(e,t,n){return{accessToken:n?n.AccessToken:e.AccessToken,accessTokenTtl:n?n.AccessTokenTtl:"",applicationModeExtended:e.SessionStartInfoJson?JSON.parse(e.SessionStartInfoJson).ApplicationModeExtended:"UNKNOWN",buildVersion:e.BuildVersion,canary:e.Canary,feMachineId:e.FEMachineId,logHostRequests:"true"===e.LogHostRequests?1:0,onenoteSyncEndpoint:e.ONOnlineSyncEndpoint,pageTarget:e.PageTarget,renderingMode:e.AddServerSideRenderingHeader,requestHeadMode:t,rootQuerySignature:e.RootQuerySignature,sessionOrigin:e.SessionOrigin?e.SessionOrigin:"UNKNOWN",url:e.WebServiceBase,userSessionId:e.SessionId,userType:e.UserType,wacCluster:e.WacCluster,wacUserAgent:e.WacUserAgent}},e.createWacBootOptions=function(e,t,n,i){return{baseDocId:e.BaseDocId,fastBootEnabled:"true"===e.FastBoot,getCachedSSR:"true"===e.GetCachedSSR,indexedDBPageTargetKey:"",initParagraphId:parseInt(e.InitialParaId,16),isIndexedDBEnabled:"true"===e.OneNoteIndexedDbCacheIsEnabled,isIndexedDBDefaultPageEnabled:"true"===e.OneNoteIndexedDBCacheDefaultPageIsEnabled,isOneNoteQuickloadCacheLocalStorageEnabled:"true"===e.OneNoteQuickloadCacheLocalStorageIsEnabled,isNewFile:"true"===e.CreateNew,isOneNoteHierarchySyncOnBootEnabled:"true"===e.OneNoteHierarchySyncIsEnabled,isOneNoteSyncConnectOnBootEnabled:"true"===e.OneNoteSyncConnectOnBootEnabled,isOneNoteSyncHeartBeatEnabled:"true"===e.OneNoteSyncHeartBeatIsEnabled,isUserCreatingPersonalNotebookFirstTime:"true"===e.IsUserCreatingPersonalNotebookFirstTime,oneNoteShouldSendQuerySignatureOnSocketSetup:"true"===e.OneNoteShouldSendQuerySignatureOnSocketSetup,contentSyncVersion:parseInt(e.OneNoteContentSyncVersion,10),optimizedForNewFile:n,pageTarget:e.PageTarget,pageTargetHtml:e.PageTargetHtml,preventCanvasShiftOnBootIsEnabled:"true"===e.PreventCanvasShiftOnBootIsEnabled,requestOptions:this.createRequestOptions(e,t,i),sessionStartJson:e.SessionStartInfoJson?this.buildSessionStartInfoJson(e.SessionStartInfoJson):"UNKNOWN",skipPageHtmlInGetCellsResponse:"true"===e.SkipPageHtmlInGetCellsResponse,slice0Name:e.Slice0Name,syncHeartBeatSendInterval:parseInt(e.OneNoteSyncHeartBeatSendIntervalMs,10),syncHeartBeatWaitInterval:parseInt(e.OneNoteSyncHeartBeatWaitIntervalMs,10),channelOutboundTimeoutInterval:parseInt(e.OneNoteSyncChannelOutboundTimeoutIntervalMs,10),userId:e.UserId}},e.buildSessionStartInfoJson=function(e){var t={},n=JSON.parse(e);return t.Application=n.Application,t.ApplicationVersion=n.ApplicationVersion,t.Browser=n.Browser,t.BrowserMajorVersion=n.BrowserMajorVersion,t.BrowserVersion=n.BrowserVersion,t.Host=n.Host,t.IsSynthetic=n.IsSynthetic,t.Os=n.Os,t.Ring=n.Ring,t.RoutedVia=n.RoutedVia,t.SessionOrigin=n.SessionOrigin,t.UiHost=n.UiHost,t.UserSessionApplicationMode=n.UserSessionApplicationMode,t.WACDatacenter=n.WACDatacenter,JSON.stringify(t)},e}();function x(){return"PerformanceObserver"in window&&"function"==typeof PerformanceObserver}function B(e,t){void 0===window.wacPerfObserver&&(window.wacPerfObserver={}),window.wacPerfObserver[e]=t}function N(e){var t;e.disconnect(),B("timeOrigin",(t=window.performance)&&t.timeOrigin?t.timeOrigin:t&&t.timing&&t.timing.navigationStart?t.timing.navigationStart:0),"function"==typeof window.CustomEvent&&window.dispatchEvent(new CustomEvent("WacStableInteractive",window.wacPerfObserver))}function T(){x()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("paint")&&new PerformanceObserver((function(e){e.getEntries().forEach((function(e){"first-paint"===e.name?B("firstPaint",e.startTime):"first-contentful-paint"===e.name&&B("firstContentfulPaint",e.startTime)}))})).observe({type:"paint",buffered:!0}),x()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("largest-contentful-paint")&&new PerformanceObserver((function(e){var t=e.getEntries();B("largestContentfulPaint",t[t.length-1].startTime)})).observe({type:"largest-contentful-paint",buffered:!0}),function(){if(x()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("element"))var e=new PerformanceObserver((function(t){t.getEntries().forEach((function(e){B("elementPaint_"+e.id,e.startTime)})),e.observe({type:"element",buffered:!0})}))}()}function W(e,t){if(t){"true"===e.WacPerfObserverEntriesIsEnabled&&(T(),window.addEventListener("WacAppInteractive",(function(){!function(e,t){if(void 0===e&&(e=[5e3]),void 0===t&&(t=12e4),x()&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("longtask")&&-1!==PerformanceObserver.supportedEntryTypes.indexOf("first-input")&&0!==e.length){var n=performance.now(),i=0,o=n,a=0,s=void 0,r=void 0,l=0,d=new PerformanceObserver((function(e){e.getEntries().forEach((function(e){if("longtask"===e.entryType){i+=1,a+=e.duration;var t=e.startTime+e.duration;o=t>o?t:o}else"first-input"===e.entryType&&(s=e.processingStart,r=s-e.startTime)}))}));d.observe({entryTypes:["longtask","first-input"]});var c=function(){var u=performance.now(),p=u-o;if(r)B("firstInputProcessingStart",s),B("FID",r),N(d);else{for(;l<e.length;l+=1){var h=e[l];if(!(p>=h-10))break;B("TTSI_"+h,o),B("longTaskCount_"+h,i),B("totalLongTasksDuration_"+h,a)}var m=u-n;if(l<e.length&&m<t){var b=e[l]-p;setTimeout(c,b)}else N(d)}};e.sort((function(e,t){return e-t})),setTimeout(c,e[0])}}([500,1e3,2e3,3e3,5e3])})));p.ensureCookieCompliance("true"===e.MSCCEnabled,e.MSCCCookies);var n=A.createWacBootOptions(e,2,!0),i=new k("true"!==e.BootReadOnlyUx,!0,!0,!1,e,!1),o=new I(i,n),a=o.makeGetCellsRequest((function(e){o.onGetCellsRequestCompleted(e),o.onInitialResponseReady()}));n.getCachedSSR&&o.makeRenderPageRequest({});var s="true"===e.WordSkeletalRibbonIsEnabled||"earlydismiss"===e.WordIsSkeletalRibbonOn||"latedismiss"===e.WordIsSkeletalRibbonOn,r="true"===e.WordIsSkeletalDeepLinkOn&&"true"===e.IsDeepLinkScenario;if((s||r)&&C.initialize(r),s&&!k.isReactMultilineRibbonVisible(e))if("false"!==p.getCookie("WordIsSimplifiedRibbonOn")){var l="true"===e.HideHeaderEmbedded;C.addComponent(function(e,t){var n=["40px","60px","60px","60px","60px","55px","90px","80px","100px","10%","17%","21%","21%","6%","6%"],i=document.createElement("div");i.id="SkeletalRibbon",i.className=i.id,i.style.marginTop=t?"0":"48px";var o=document.createElement("div");o.id="ribbonContent",o.className=o.id,o.style.backgroundColor="#F3F2F1",o.style.height="76px",o.style.transition="opacity 0.1s",o.style.borderBottom="none",o.style.width="100%",o.style.minWidth="640px",o.setAttribute("unselectable","on");var a=document.createElement("div");a.id="topbar",a.className="topbar",a.style.height="38px",a.style.width="100%",a.style.display="flex",a.style.alignItems="center",a.style.justifyContent="space-between";var s=document.createElement("div");s.style.height="16px",s.style.display="flex",s.style.justifyContent="flex-start";for(var r=[],l=0;l<=14;l+=1)r[l]=document.createElement("div"),r[l].style.backgroundColor=e,r[l].style.borderRadius="2px",r[l].style.height="100%",r[l].style.marginLeft="8px",r[l].style.marginRight="8px",r[l].style.outline="transparent",r[l].style.border="1px solid transparent",r[l].style.width=n[l];var d=document.createElement("div");d.style.height="24px",d.style.display="flex";var c=[];for(l=0;l<4;l+=1)c[l]=document.createElement("div"),c[l].style.width="24px",c[l].style.borderRadius="50%",c[l].style.backgroundColor=e,c[l].style.marginLeft="4px",c[l].style.marginRight="4px",c[l].style.outline="transparent",c[l].style.border="1px solid transparent",d.appendChild(c[l]);d.appendChild(r[7]),d.appendChild(r[8]);var u=document.createElement("div");u.id="bottombar",u.className="bottombar",u.style.height="38px",u.style.width="100%",u.style.display="flex",u.style.alignItems="center";var p=document.createElement("div");for(p.style.height="22px",p.style.display="flex",p.style.width="100%",l=0;l<=6;l+=1)s.appendChild(r[l]);for(l=9;l<=14;l+=1)p.appendChild(r[l]);var h=[window.matchMedia("(max-width: 700px)"),window.matchMedia("(max-width: 810px)"),window.matchMedia("(max-width: 1116px)")];for(m(),l=0;l<h.length;l+=1)h[l].addListener(m);function m(){h[0].matches?(r[7].style.width="32px",r[8].style.width="32px",r[6].style.display="none",r[5].style.display="none"):h[1].matches?(r[7].style.width="32px",r[8].style.width="32px",r[6].style.display="none"):h[2].matches&&(r[7].style.width="32px",r[8].style.width="32px")}var b=document.createElement("div");return b.id="highContrastCover",b.className=b.id,b.style.height="4px",b.style.backgroundColor="rgba(0, 0, 0, 0)",a.appendChild(s),a.appendChild(d),u.appendChild(p),o.appendChild(a),o.appendChild(u),i.appendChild(o),i.appendChild(b),{isReady:!1,element:i}}(C.getSkeletalComponentColor(),l))}return(s||r)&&C.launchExperience(),a}}function M(e){var t=document.getElementById("WACFastView"),n=t.querySelector(".WACViewPanel"),i=t.querySelector(".OutlineContainer"),o=t.querySelector(".Outline"),a=t.querySelector(".PageContentOrigin");i&&(i.style.minHeight="0",i.style.left="-140px"),n&&(n.style.overflow="hidden"),a&&(a.style.top="-1px",a.style.width="calc(100% - "+function(){var e=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll",e.style.msOverflowStyle="scrollbar",document.body.appendChild(e);var t=document.createElement("div");e.appendChild(t);var n=e.offsetWidth-t.offsetWidth;return e.parentNode.removeChild(e),n}()+"px)");var s=document.createElement("div");return s.id="SkeletalPage",s.className=s.id,s.style.position="absolute",s.style.width="100%",s.style.height="100%",s.style.left="0",s.style.right="0",s.style.top="0",s.style.zIndex="1",s.style.backgroundColor="window",s.appendChild(function(e){var t=document.createElement("div");t.id="SkeletalCanvas",t.className=t.id,t.style.width="100%",t.style.height="100%",t.style.overflow="hidden",t.style.position="relative";var n=document.getElementById("WACFastView").querySelector(".OutlineContent"),i=document.createElement("div");i.style.width="100%",i.style.height="100%",i.style.boxSizing="border-box",n&&(i.style.paddingLeft=n.style.paddingLeft,i.style.paddingRight=n.style.paddingRight,i.style.paddingTop=n.style.paddingTop);for(var o=[],a=0;a<2;a+=1)o[a]=document.createElement("div"),o[a].style.backgroundColor=e,o[a].style.height="18px",o[a].style.marginBottom="16px";o[0].style.width="150px",o[1].style.width="220px";var s=[];for(a=0;a<21;a+=1)s[a]=document.createElement("div"),s[a].style.backgroundColor=e,s[a].style.height="14px",s[a].style.marginBottom="6px";s[0].style.width="92%",s[1].style.width="100%",s[2].style.width="93%",s[3].style.width="80%",s[3].style.marginBottom="16px",s[4].style.width="92%",s[5].style.width="100%",s[6].style.width="55%",s[6].style.marginBottom="16px",s[7].style.width="95%",s[8].style.width="38%",s[8].style.marginBottom="26px",s[9].style.width="90%",s[10].style.width="100%",s[11].style.width="98%",s[12].style.width="100%",s[13].style.width="33%",s[13].style.marginBottom="16px",s[14].style.width="91%",s[15].style.width="90%",s[16].style.width="100%",s[17].style.width="85%",s[17].style.marginBottom="40px",s[18].style.width="92%",s[19].style.width="100%",s[20].style.width="93%",i.appendChild(o[0]);for(a=0;a<=17;a+=1)i.appendChild(s[a]);i.appendChild(o[1]);for(a=18;a<=19;a+=1)i.appendChild(s[a]);return t.appendChild(i),t}(e)),s.appendChild(function(e){var t=document.createElement("div");t.id="SkeletalFloaties",t.className=t.id,t.style.position="absolute",t.style.top="20px",t.style.right="-300px",t.style.width="270px";for(var n=[],i=0;i<3;i+=1){n[i]=document.createElement("div"),n[i].id="SkeletalFloatie",n[i].className=n[i].id,n[i].style.boxSizing="border-box",n[i].style.position="relative",n[i].style.width="100%",n[i].style.backgroundColor="window",n[i].style.padding="15px",n[i].style.paddingBottom="22px",n[i].style.marginBottom="14px";var o=document.createElement("div");o.id="SkeletalTitle",o.className=o.id,o.style.backgroundColor=e,o.style.width="42%",o.style.height="18px",o.style.borderRadius="2px",o.style.marginBottom="11px";for(var a=[],s=0;s<3;s+=1)a[s]=document.createElement("div"),a[s].id="SkeletalParagraph",a[s].className=a[s].id,a[s].style.marginTop="6px",a[s].style.backgroundColor=e,a[s].style.height="14px",a[s].style.borderRadius="2px",a[s].style.width="100%";a[0].style.width="100%",a[1].style.width="85%",a[2].style.width="70%",n[i].appendChild(o);for(var r=0;r<3;r+=1)n[i].appendChild(a[r]);t.appendChild(n[i])}return t}(e)),o&&(o.style.overflow="visible",o.appendChild(s)),{isReady:!1,element:s}}var F=function(){function e(e,t,n){this.success=e,this.errorCode=t,this.extraErrorInfo=n}return e.createSuccess=function(){return new e(!0)},e.createFailure=function(t,n){return new e(!1,t,n)},e}(),D=function(){function e(e){this.wacInitializeReadyRetryCount=0,this.wacInitializeReadyAckReceived=!1,this.wopiStartSessionCompleteReceived=!1,this.wopiPendingSessionCompleteReceived=!1,this.wopiStartSessionSentFromWacFrame=!1,this.instantBootPltDiagnostics={},this.instantAppSettings=e,this.logs=[],this.postMessageOrigin=this.instantAppSettings.PostMessageOrigin,this.acceptStartSessionComplete="true"===this.instantAppSettings.AcceptStartSessionComplete}return e.getWindow=function(){return window},e.prototype.launchFastView=function(t,n,i,o){void 0===i&&(i=!1),void 0===o&&(o=1),e.getWindow().g_liveBooksAppConstructed&&this.log("App constructed before launching FastView"),u.fastView&&u.fastView.isOpen()&&this.log("FastView was already opened");var a=new k(!0,!0,!0,!1,this.instantAppSettings,!1).launchFastView(t,"WordEditorInstantApp",n,!1,i,o);if("true"===this.instantAppSettings.WordIsSkeletalDeepLinkOn&&"true"===this.instantAppSettings.IsDeepLinkScenario&&a)return C.addComponentOutsideSkeletalContainer(M(C.getSkeletalComponentColor())),void C.addShimmerToElement("SkeletalCanvas");"true"===this.instantAppSettings.SkeletalParagraphIsEnabled&&a&&this.addSkeletalParagraph()},e.prototype.trackOfficeServerDiagnostics=function(e){this.officeFrameDocumentFlushTime=Date.now(),this.serverDiagnostics=e},e.prototype.sendAppFailedMessage=function(t){this.sendPostMessageToParentWindow(e.toJsApiAppFailed,{Error:{errorType:t}},"*")},e.prototype.signalReady=function(){var e=this;window.addEventListener("message",(function(t){e.receivePostMessage(t)}),!1),this.sendReadyMessage();var t=Number(this.instantAppSettings.WopiPendingSessionMessageTimeoutInMs);t||(t=1e4),window.setTimeout((function(){return e.timeoutWopiPendingSessionMessage()}),t)},e.prototype.startWacBoot=function(e){var t=e||this.instantAppSettings;this.getCellsConnection=W(t,!0)},e.prototype.abortGetCellsConnection=function(){this.getCellsConnection&&this.getCellsConnection.abort()},e.prototype.getCellsFromFrameRequest=function(e){I.getCellsFromFrameRequest(e),this.abortGetCellsConnection()},e.prototype.addSkeletalParagraph=function(){try{var e=document.getElementById("WACFastView"),t=e.querySelectorAll(".Paragraph").length;if(20!==t&&60!==t)return!1;var n=e.querySelector(".Outline");if(n){var i=function(e,t){var n=document.createElement("div");n.id="SkeletalParagraph",n.style.width="100%",n.style.overflow="hidden",n.style.position="relative";var i=document.createElement("div");i.style.width="100%",i.style.boxSizing="border-box";var o=e.querySelectorAll(".OutlineElement");-1!==o[o.length-1].className.toLowerCase().indexOf("rtl")&&(i.style.direction="rtl");var a=e.querySelector(".OutlineContent");a&&(i.style.paddingLeft=a.style.paddingLeft,i.style.paddingRight=a.style.paddingRight);for(var s=["92%","100%","93%","80%"],r=0;r<s.length;r+=1){var l=document.createElement("div");l.style.backgroundColor=t,l.style.width=s[r],l.style.height="14px",l.style.marginBottom="6px",i.appendChild(l)}return n.appendChild(i),n}(e,C.getSkeletalComponentColor());n.appendChild(i),C.addShimmerToElement(i.id)}}catch(e){return this.log("failed to add skeletal paragraph: "+e.message+"\r\n"+e.stack),!1}return!0},e.prototype.sendPostMessageToParentWindow=function(e,t,n){var i={MessageId:e,SendTime:Date.now(),Values:t},o=this.postMessageOrigin;n&&(o=n),window.parent.postMessage(JSON.stringify(i),o),this.log("Sent "+e)},e.prototype.receivePostMessage=function(t){if(t.origin===this.postMessageOrigin){var n;try{n=JSON.parse(t.data)}catch(e){return}switch(n.MessageId){case e.fromJsApiInitReadyAck:this.log("WacInitialize_Ready_Ack received"),this.wacInitializeReadyAckReceived=!0;break;case e.fromJsApiPendingSessionFail:if(this.log("WopiPendingSession_Fail received"),this.wopiPendingSessionCompleteReceived)return void this.log("WopiPendingSession_Fail received after a Complete/Fail was already received previously.");this.wopiPendingSessionCompleteReceived=!0,this.wopiStartSessionCompleteReceived=!0,this.initializeAppOnFailure("WopiPendingSession_Fail");break;case e.fromJsApiPendingSessionComplete:this.log("WopiPendingSession_Complete received"),this.sendPostMessageToParentWindow(e.toJsApiSessionCompleteAck,{}),this.wopiPendingSessionCompleteReceived&&this.log("WopiPendingSession_Complete received after a Complete/Fail was already received previously."),this.wopiPendingSessionCompleteReceived=!0;var i=n.Values.WopiDetails;this.instantBootPltDiagnostics=n.Values.Diagnostics||{},this.makeStartSessionRequest(i),this.beginStartSessionTimeout(!0);break;case e.fromJsApiStartSessionComplete:if(this.log("WopiStartSession_Complete received"),this.sendPostMessageToParentWindow(e.toJsApiSessionCompleteAck,{}),this.wopiStartSessionCompleteReceived)return void this.log("WopiStartSession_Complete received after a Complete/Fail was already received previously.");if(!this.acceptStartSessionComplete)return void this.log("WopiStartSession_Complete rejected");if(!n.Values.StartSessionResponse)return void this.log("WopiStartSession_Complete invalid content");this.wopiStartSessionCompleteReceived=!0,this.wopiPendingSessionCompleteReceived||(this.wopiPendingSessionCompleteReceived=!0);var o=n.Values.StartSessionResponse;this.instantBootPltDiagnostics=n.Values.Diagnostics||{},this.processStartSessionResponse(!1,o.RequestStatus,o.ResponseText);break;case e.fromJsApiPendingAppCompleteReceived:this.log("WopiPendingApplicationComplete_Received received on wac frame"),this.wopiPendingSessionCompleteReceived||(this.wopiPendingSessionCompleteReceived=!0),this.beginStartSessionTimeout(!1)}}},e.prototype.beginStartSessionTimeout=function(e){var t=this,n=Number(this.instantAppSettings.WopiStartSessionTimeoutInMs);n||(n=1e4),e?(this.wopiStartSessionSentFromWacFrame=!0,window.setTimeout((function(){return t.timeoutWopiStartSessionFromWacFrameMessage()}),n)):window.setTimeout((function(){return t.timeoutWopiStartSessionFromJsApiMessage()}),n)},e.prototype.sendReadyMessage=function(){var t=this;this.sendPostMessageToParentWindow(e.toJsApiInitReady,{CanAcceptStartSessionComplete:this.acceptStartSessionComplete,Diagnostics:{officeSessionId:this.instantAppSettings.SessionId}}),window.setTimeout((function(){return t.timeoutWacInitializeReadyAckMessage()}),e.wacInitializeReadyAckTimeoutInMs)},e.prototype.timeoutWacInitializeReadyAckMessage=function(){this.wacInitializeReadyAckReceived||this.wopiPendingSessionCompleteReceived||(this.wacInitializeReadyRetryCount+=1,this.wacInitializeReadyRetryCount<e.wacInitializeReadyMaxRetries?(this.sendReadyMessage(),this.log("WacInitializeReadyAckTimeout. [RetriesRemain:"+(e.wacInitializeReadyMaxRetries-this.wacInitializeReadyRetryCount)+"]")):this.log("WacInitializeReadyAckTimeout. No retries remain"))},e.prototype.timeoutWopiPendingSessionMessage=function(){this.wopiPendingSessionCompleteReceived||this.initializeAppOnFailure("WopiPendingSession_Timeout")},e.prototype.timeoutWopiStartSessionFromJsApiMessage=function(){this.wopiStartSessionCompleteReceived||this.wopiStartSessionSentFromWacFrame||this.initializeAppOnFailure("StartSession_Fail")},e.prototype.timeoutWopiStartSessionFromWacFrameMessage=function(){this.wopiStartSessionCompleteReceived||this.initializeAppOnFailure("StartSession_Fail")},e.prototype.makeStartSessionRequest=function(e){var t=this,n=A.createWacBootOptions(this.instantAppSettings,0,!0,e),i=new I(null,n),o="WOPIsrc="+encodeURIComponent(e.WopiSrc);window.location.search&&(o+="&"+window.location.search.substr(1)),"true"===this.instantAppSettings.FileGetUrlPresent&&(o+="&fileGetUrlPresent=1"),this.instantBootPltDiagnostics.startSessionStartTime=Date.now(),i.makeStartSessionRequest("WordEditorStartSession.ashx?"+o,(function(e){return t.processStartSessionResponse(!0,e._xmlHttpRequest.status,e._xmlHttpRequest.responseText)}))},e.prototype.getAppSettingsFromResponse=function(e){try{return{success:!0,appSettings:JSON.parse(e)}}catch(e){return{success:!1,errorInfo:e.message+"\r\n"+e.stack}}},e.prototype.processStartSessionResponse=function(t,n,i){var o=this,a=Date.now();if(this.wopiStartSessionCompleteReceived=!0,200===n){var s,r=this.getAppSettingsFromResponse(i);if(r.success)(s=r.appSettings)&&s.UrlToRedirect&&window.top.location.replace(s.UrlToRedirect),this.instantBootPltDiagnostics.isStartSessionFromWac=t,t&&(this.instantBootPltDiagnostics.startSessionCompleteTime=a),this.instantBootPltDiagnostics.appSettingsFetchedTime=Date.now(),E=r.appSettings,e.instantAppSettingsToPreserve.forEach((function(e){E&&e in o.instantAppSettings&&(E[e]=o.instantAppSettings[e])})),e.getWindow().g_appSettings=E,e.getWindow().g_appSettingsDownloaded=!0,this.initializeApp(F.createSuccess());else this.initializeAppOnFailure("StartSession_AppSettingsParseError",r.errorInfo)}else this.initializeAppOnFailure("StartSession_Fail","Status "+n)},e.prototype.initializeAppOnFailure=function(t,n){E=this.instantAppSettings,e.getWindow().g_appSettings=E,e.getWindow().g_appSettingsDownloaded=!0,this.initializeApp(F.createFailure(t,n))},e.prototype.initializeApp=function(t){t.success&&E?this.startWacBoot(E):(this.sendBeacon("WordEditorInstantAppBootError",{errorCode:t.errorCode,extraErrorInfo:t.extraErrorInfo}),E&&t.errorCode&&(E.InstantBoot_FailureCode=t.errorCode),t.errorCode&&t.extraErrorInfo&&E&&(E[t.errorCode]=t.extraErrorInfo)),this.sendBeacon("WordEditorInstantAppLogs",this.logs),e.getWindow().g_livebooksJsDownloaded&&(e.getWindow().Sys.Application.get_isInitialized()?e.getWindow().g_liveBooksAppConstructed||pageInit():(e.getWindow().Sys.Application.add_init(pageInit),e.getWindow().Sys.Application.initialize()))},e.prototype.log=function(e){this.logs.push({time:Date.now(),message:e})},e.prototype.sendBeacon=function(t,n){e.getWindow()._bB&&e.getWindow()._bB.sendBeacon(t,n)},e.fromJsApiInitReadyAck="WacInitialize_Ready_Ack",e.fromJsApiPendingSessionComplete="WopiPendingSession_Complete",e.fromJsApiPendingSessionFail="WopiPendingSession_Fail",e.fromJsApiPendingAppCompleteReceived="WopiPendingApplicationComplete_Received",e.fromJsApiStartSessionComplete="WopiStartSession_Complete",e.toJsApiInitReady="WacInitialize_Ready",e.toJsApiAppFailed="Wac_AppFailed",e.toJsApiSessionCompleteAck="WopiSession_Complete_Ack",e.wacInitializeReadyMaxRetries=3,e.wacInitializeReadyAckTimeoutInMs=1e3,e.instantAppSettingsToPreserve=["MSCCCookies","MSCCEnabled","MSCCMarkup","RibbonImageBase","SharedStaticContentHost","Slice1Name","StaticContentHost","WacRootDomain","WacBootNewJSIsEnabled","jQueryName","signalRName","CollabSliceName"],e}(),L=r;n.d(t,"show",(function(){return!1})),n.d(t,"dispose",(function(){return!1})),n.d(t,"getRegion",(function(){return!1})),n.d(t,"WindowUtil",(function(){return L})),n.d(t,"CtrlWheelMetrics",(function(){return l})),n.d(t,"FastViewAppearance",(function(){return v})),n.d(t,"FastViewLogEntry",(function(){return S})),n.d(t,"FastView",(function(){return y})),n.d(t,"FastViewUtils",(function(){return p})),n.d(t,"PerfUtils",(function(){return g})),n.d(t,"ShiftUtils",(function(){return w})),n.d(t,"SkeletalBoot",(function(){return f})),n.d(t,"bootSettings",(function(){return c})),n.d(t,"FastViewSettings",(function(){return u})),n.d(t,"WacSkeletalBoot",(function(){return C})),n.d(t,"WindowVisibilityMetrics",(function(){return R})),n.d(t,"setHeaderRenderer",(function(){return a})),n.d(t,"getHeaderRenderer",(function(){return s})),n.d(t,"WordEditorInstantAppResult",(function(){return F})),n.d(t,"WordEditorInstantApp",(function(){return D})),n.d(t,"startWacBoot",(function(){return W})),a((function(e,t){return Object(o.b)(void 0,void 0,void 0,(function(){var i;return Object(o.c)(this,(function(o){switch(o.label){case 0:return[4,n.e(0).then(n.bind(null,27))];case 1:return i=o.sent().createInitialRenderHeader,i()(e,t),[2]}}))}))}))}]);
//# sourceMappingURL=wacBoot.min.js.map